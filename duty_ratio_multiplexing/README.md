# 空占比复用
在嵌入式 LCD 显示屏接口中总会有一个用于切换 命令/数据 状态的 A0(CD) 引脚。
支持并口显示控制的 MCU 大多包含对该引脚的管理，但当我们想要使用 SPI 来节省 IO 口时会需要手动对 A0 切换。
通常通过 GPIO 控制的 A0 引脚速度比较慢，此时会降低随机绘点的效率，本节介绍空占比复用的时钟取代 A0。

## 原理
```
       +-+   +-+            +---+ +---+ +---+
       | |   | |            |   | |   | |   |
CLK ---+ +---+ +--- ...... -+   +-+   +-+   +-

- 2:1 空占比的时钟表示操作寄存器
- 1:2 空占比的时钟表示操作数据
- 无操作时拉高 CS 除能

补充：
- MCU 可以在初始化 LCD 时，发送的第一个命令用于确定 SPI 频率以及设置空占比
- 当然我们可以通过较高频率的 50% 空占比的时钟生成空占比更大的新时钟，LCD 的接收端时钟专门接个缓冲区

               [C0][-]
                |
[CLK]-+-*[B0]---+---*[B1]----[A0]
      |
      +-*[B2]---------------[SCK]

      -----信号方向---->

[C] 为电容
[B] 为缓冲器(* 为输入端)

说明：
- 对于 3.3v 电平，空占比达到 9:1 的时钟信号在电容 C0 的作用下，让 B1 的输入电压呈现低于 0.33v 的低电平
  反之 1:9 空占比的时钟信号则会让 B1 的输入端呈现高电平
- 通常 LCD 寄存器是 16bit 宽度，而数据是 8bit，电容 C0 而言至少有 8 倍时钟周期的时间可以充放电，
  完全可以在读取完数据后再判断 A0 的状态
- 该方式需要配置电容的规格以适应不同的时钟频率和空占比
```
